# æ¶ˆæ¯ä¸­å¿ƒæ¨¡å—æ¥å£æ–‡æ¡£

## æ–‡æ¡£ä¿¡æ¯
- **æ–‡æ¡£åç§°**: æ¶ˆæ¯ä¸­å¿ƒæ¨¡å—æ¥å£æ–‡æ¡£
- **ç‰ˆæœ¬**: 1.0.0
- **æ›´æ–°æ—¶é—´**: 2024-01-31
- **æè¿°**: æ¶ˆæ¯ä¸­å¿ƒæ¨¡å—ç›¸å…³çš„APIæ¥å£æ–‡æ¡£

---

## ç›®å½•
1. [ç‚¹èµé€šçŸ¥æ¥å£](#1-ç‚¹èµé€šçŸ¥æ¥å£)
2. [è¯„è®ºé€šçŸ¥æ¥å£](#2-è¯„è®ºé€šçŸ¥æ¥å£)
3. [ç•™è¨€æ¿åŠŸèƒ½æ¥å£](#3-ç•™è¨€æ¿åŠŸèƒ½æ¥å£)
4. [æ¶ˆæ¯ä¼šè¯ç®¡ç†](#4-æ¶ˆæ¯ä¼šè¯ç®¡ç†)
5. [é€šç”¨å“åº”æ ¼å¼](#5-é€šç”¨å“åº”æ ¼å¼)
6. [é”™è¯¯ç è¯´æ˜](#6-é”™è¯¯ç è¯´æ˜)
7. [æ³¨æ„äº‹é¡¹](#7-æ³¨æ„äº‹é¡¹)

---

## 1. ç‚¹èµé€šçŸ¥æ¥å£

### 1.1 ç»™æˆ‘çš„å†…å®¹ç‚¹èµçš„æœç´¢
- **æ¥å£è·¯å¾„**: `GET /api/v1/messages/list`
- **è¯·æ±‚æ–¹å¼**: GET
- **åŠŸèƒ½æè¿°**: æœç´¢ç»™æˆ‘çš„å†…å®¹ç‚¹èµçš„é€šçŸ¥æ¶ˆæ¯

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | æè¿° |
|--------|------|------|--------|------|
| receiverId | Long | æ˜¯ | - | æ¥æ”¶è€…IDï¼ˆå½“å‰ç”¨æˆ·ï¼‰ |
| messageType | String | å¦ | LIKE | æ¶ˆæ¯ç±»å‹ï¼šLIKEã€COMMENTã€SHAREç­‰ |
| status | String | å¦ | - | æ¶ˆæ¯çŠ¶æ€ |
| isRead | Boolean | å¦ | - | æ˜¯å¦å·²è¯»ï¼štrueã€false |
| keyword | String | å¦ | - | å…³é”®è¯æœç´¢ |
| currentPage | Integer | å¦ | 1 | å½“å‰é¡µç  |
| pageSize | Integer | å¦ | 20 | é¡µé¢å¤§å° |

#### è¯·æ±‚ç¤ºä¾‹
```http
GET /api/v1/messages/list?receiverId=123&messageType=LIKE&currentPage=1&pageSize=20
```

#### å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "records": [
      {
        "id": 1,
        "senderId": 456,
        "senderNickname": "ç‚¹èµç”¨æˆ·",
        "senderAvatar": "https://example.com/avatar.jpg",
        "receiverId": 123,
        "contentId": 789,
        "contentTitle": "æˆ‘çš„è§†é¢‘å†…å®¹",
        "contentType": "VIDEO",
        "messageType": "LIKE",
        "content": "ç”¨æˆ·ç‚¹èµäº†ä½ çš„å†…å®¹",
        "isRead": false,
        "createTime": "2024-01-30T10:30:00"
      }
    ],
    "total": 50,
    "currentPage": 1,
    "pageSize": 20,
    "totalPages": 3
  }
}
```

### 1.2 ç‚¹èµé€šçŸ¥ç»Ÿè®¡
- **æ¥å£è·¯å¾„**: `GET /api/v1/messages/list`
- **è¯·æ±‚æ–¹å¼**: GET
- **åŠŸèƒ½æè¿°**: è·å–æœªè¯»ç‚¹èµé€šçŸ¥æ•°é‡

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| receiverId | Long | æ˜¯ | æ¥æ”¶è€…IDï¼ˆå½“å‰ç”¨æˆ·ï¼‰ |
| messageType | String | å¦ | LIKE | æ¶ˆæ¯ç±»å‹ï¼šLIKE |
| isRead | Boolean | å¦ | false | æ˜¯å¦å·²è¯»ï¼šfalseè¡¨ç¤ºæœªè¯» |

#### è¯·æ±‚ç¤ºä¾‹
```http
GET /api/v1/messages/list?receiverId=123&messageType=LIKE&isRead=false&currentPage=1&pageSize=1000
```

---

## 2. è¯„è®ºé€šçŸ¥æ¥å£

### 2.1 ç»™æˆ‘çš„å†…å®¹è¯„è®ºçš„æœç´¢
- **æ¥å£è·¯å¾„**: `GET /api/v1/messages/list`
- **è¯·æ±‚æ–¹å¼**: GET
- **åŠŸèƒ½æè¿°**: æœç´¢ç»™æˆ‘çš„å†…å®¹è¯„è®ºçš„é€šçŸ¥æ¶ˆæ¯

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | æè¿° |
|--------|------|------|--------|------|
| receiverId | Long | æ˜¯ | - | æ¥æ”¶è€…IDï¼ˆå½“å‰ç”¨æˆ·ï¼‰ |
| messageType | String | å¦ | COMMENT | æ¶ˆæ¯ç±»å‹ï¼šCOMMENTã€REPLY |
| status | String | å¦ | - | æ¶ˆæ¯çŠ¶æ€ |
| isRead | Boolean | å¦ | - | æ˜¯å¦å·²è¯» |
| keyword | String | å¦ | - | å…³é”®è¯æœç´¢ |
| currentPage | Integer | å¦ | 1 | å½“å‰é¡µç  |
| pageSize | Integer | å¦ | 20 | é¡µé¢å¤§å° |

#### è¯·æ±‚ç¤ºä¾‹
```http
GET /api/v1/messages/list?receiverId=123&messageType=COMMENT&currentPage=1&pageSize=20
```

#### å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "records": [
      {
        "id": 2,
        "senderId": 789,
        "senderNickname": "è¯„è®ºç”¨æˆ·",
        "senderAvatar": "https://example.com/avatar2.jpg",
        "receiverId": 123,
        "contentId": 789,
        "contentTitle": "æˆ‘çš„è§†é¢‘å†…å®¹",
        "commentId": 101,
        "commentContent": "è¿™ä¸ªè§†é¢‘å¾ˆæ£’ï¼",
        "messageType": "COMMENT",
        "content": "ç”¨æˆ·è¯„è®ºäº†ä½ çš„å†…å®¹",
        "isRead": false,
        "createTime": "2024-01-30T11:00:00"
      }
    ],
    "total": 30,
    "currentPage": 1,
    "pageSize": 20,
    "totalPages": 2
  }
}
```

### 2.2 è¯„è®ºé€šçŸ¥ç»Ÿè®¡
- **æ¥å£è·¯å¾„**: `GET /api/v1/messages/list`
- **è¯·æ±‚æ–¹å¼**: GET
- **åŠŸèƒ½æè¿°**: è·å–æœªè¯»è¯„è®ºé€šçŸ¥æ•°é‡

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| receiverId | Long | æ˜¯ | æ¥æ”¶è€…IDï¼ˆå½“å‰ç”¨æˆ·ï¼‰ |
| messageType | String | å¦ | COMMENT | æ¶ˆæ¯ç±»å‹ï¼šCOMMENT |
| isRead | Boolean | å¦ | false | æ˜¯å¦å·²è¯»ï¼šfalseè¡¨ç¤ºæœªè¯» |

---

## 3. ç•™è¨€æ¿åŠŸèƒ½æ¥å£

### 3.1 å‘è¡¨ç•™è¨€
- **æ¥å£è·¯å¾„**: `POST /api/v1/messages`
- **è¯·æ±‚æ–¹å¼**: POST
- **åŠŸèƒ½æè¿°**: åœ¨ç•™è¨€æ¿å‘è¡¨ç•™è¨€

#### è¯·æ±‚å‚æ•°
```json
{
  "senderId": 123,
  "receiverId": 456,
  "content": "ä½ å¥½ï¼Œæˆ‘æƒ³å’Œä½ äº¤æµä¸€ä¸‹",
  "messageType": "BOARD",
  "isPublic": true
}
```

#### è¯·æ±‚å‚æ•°è¯´æ˜
| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| senderId | Long | æ˜¯ | å‘é€è€…ID |
| receiverId | Long | æ˜¯ | æ¥æ”¶è€…ID |
| content | String | æ˜¯ | ç•™è¨€å†…å®¹ |
| messageType | String | æ˜¯ | æ¶ˆæ¯ç±»å‹ï¼šBOARDï¼ˆç•™è¨€æ¿ï¼‰ |
| isPublic | Boolean | å¦ | æ˜¯å¦å…¬å¼€ï¼Œé»˜è®¤true |

#### å“åº”ç¤ºä¾‹
```json
{
  "code": 200,
  "message": "ç•™è¨€å‘è¡¨æˆåŠŸ",
  "data": {
    "id": 3,
    "senderId": 123,
    "senderNickname": "å‘é€è€…",
    "receiverId": 456,
    "receiverNickname": "æ¥æ”¶è€…",
    "content": "ä½ å¥½ï¼Œæˆ‘æƒ³å’Œä½ äº¤æµä¸€ä¸‹",
    "messageType": "BOARD",
    "isPublic": true,
    "status": "ACTIVE",
    "createTime": "2024-01-30T12:00:00"
  }
}
```

### 3.2 æ¥æ”¶ç•™è¨€
- **æ¥å£è·¯å¾„**: `GET /api/v1/messages/list`
- **è¯·æ±‚æ–¹å¼**: GET
- **åŠŸèƒ½æè¿°**: è·å–æ¥æ”¶åˆ°çš„ç•™è¨€æ¿æ¶ˆæ¯

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | æè¿° |
|--------|------|------|--------|------|
| receiverId | Long | æ˜¯ | - | æ¥æ”¶è€…IDï¼ˆå½“å‰ç”¨æˆ·ï¼‰ |
| messageType | String | å¦ | BOARD | æ¶ˆæ¯ç±»å‹ï¼šBOARD |
| isRead | Boolean | å¦ | - | æ˜¯å¦å·²è¯» |
| currentPage | Integer | å¦ | 1 | å½“å‰é¡µç  |
| pageSize | Integer | å¦ | 20 | é¡µé¢å¤§å° |

#### è¯·æ±‚ç¤ºä¾‹
```http
GET /api/v1/messages/list?receiverId=456&messageType=BOARD&currentPage=1&pageSize=20
```

### 3.3 ç•™è¨€å›å¤
- **æ¥å£è·¯å¾„**: `POST /api/v1/messages`
- **è¯·æ±‚æ–¹å¼**: POST
- **åŠŸèƒ½æè¿°**: å›å¤ç•™è¨€æ¿æ¶ˆæ¯

#### è¯·æ±‚å‚æ•°
```json
{
  "senderId": 456,
  "receiverId": 123,
  "parentMessageId": 3,
  "content": "å¥½çš„ï¼Œæˆ‘ä»¬å¯ä»¥äº¤æµä¸€ä¸‹",
  "messageType": "BOARD_REPLY"
}
```

#### è¯·æ±‚å‚æ•°è¯´æ˜
| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| senderId | Long | æ˜¯ | å‘é€è€…ID |
| receiverId | Long | æ˜¯ | æ¥æ”¶è€…ID |
| parentMessageId | Long | æ˜¯ | åŸç•™è¨€ID |
| content | String | æ˜¯ | å›å¤å†…å®¹ |
| messageType | String | æ˜¯ | æ¶ˆæ¯ç±»å‹ï¼šBOARD_REPLYï¼ˆç•™è¨€å›å¤ï¼‰ |

---

## 4. æ¶ˆæ¯ä¼šè¯ç®¡ç†

### 4.1 åˆ›å»ºç§ä¿¡ä¼šè¯
- **æ¥å£è·¯å¾„**: `POST /api/v1/sessions`
- **è¯·æ±‚æ–¹å¼**: POST
- **åŠŸèƒ½æè¿°**: åˆ›å»ºæ–°çš„ç§ä¿¡ä¼šè¯

#### è¯·æ±‚å‚æ•°
```json
{
  "userId": 123,
  "otherUserId": 456,
  "sessionType": "PRIVATE",
  "title": "ç§ä¿¡ä¼šè¯",
  "description": "ç”¨æˆ·é—´çš„ç§ä¿¡äº¤æµ"
}
```

### 4.2 è·å–ä¼šè¯åˆ—è¡¨
- **æ¥å£è·¯å¾„**: `GET /api/v1/sessions`
- **è¯·æ±‚æ–¹å¼**: GET
- **åŠŸèƒ½æè¿°**: è·å–ç”¨æˆ·çš„æ¶ˆæ¯ä¼šè¯åˆ—è¡¨

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | æè¿° |
|--------|------|------|--------|------|
| userId | Long | æ˜¯ | - | ç”¨æˆ·ID |
| sessionType | String | å¦ | - | ä¼šè¯ç±»å‹ï¼šPRIVATEã€GROUP |
| status | String | å¦ | ACTIVE | ä¼šè¯çŠ¶æ€ |
| currentPage | Integer | å¦ | 1 | å½“å‰é¡µç  |
| pageSize | Integer | å¦ | 20 | é¡µé¢å¤§å° |

### 4.3 è·å–ä¼šè¯æ¶ˆæ¯
- **æ¥å£è·¯å¾„**: `GET /api/v1/sessions/{sessionId}/messages`
- **è¯·æ±‚æ–¹å¼**: GET
- **åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šä¼šè¯çš„æ¶ˆæ¯è®°å½•

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| sessionId | String | æ˜¯ | ä¼šè¯IDï¼ˆè·¯å¾„å‚æ•°ï¼‰ |
| currentPage | Integer | å¦ | å½“å‰é¡µç  |
| pageSize | Integer | å¦ | é¡µé¢å¤§å° |

### 4.4 èŠå¤©è®°å½•æŸ¥è¯¢
- **æ¥å£è·¯å¾„**: `GET /api/v1/messages/chat-history`
- **è¯·æ±‚æ–¹å¼**: GET
- **åŠŸèƒ½æè¿°**: æŸ¥è¯¢ä¸¤ç”¨æˆ·é—´çš„èŠå¤©è®°å½•

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| userId1 | Long | æ˜¯ | ç”¨æˆ·1ID |
| userId2 | Long | æ˜¯ | ç”¨æˆ·2ID |
| status | String | å¦ | æ¶ˆæ¯çŠ¶æ€ |
| currentPage | Integer | å¦ | å½“å‰é¡µç  |
| pageSize | Integer | å¦ | é¡µé¢å¤§å° |

#### è¯·æ±‚ç¤ºä¾‹
```http
GET /api/v1/messages/chat-history?userId1=123&userId2=456&currentPage=1&pageSize=50
```

---

## 5. é€šç”¨å“åº”æ ¼å¼

### æˆåŠŸå“åº”
```json
{
  "code": 200,
  "message": "success",
  "data": {
    // å…·ä½“æ•°æ®
  }
}
```

### åˆ†é¡µå“åº”
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "records": [
      // æ•°æ®åˆ—è¡¨
    ],
    "total": 100,
    "currentPage": 1,
    "pageSize": 20,
    "totalPages": 5
  }
}
```

### é”™è¯¯å“åº”
```json
{
  "code": 400,
  "message": "é”™è¯¯ä¿¡æ¯",
  "data": null
}
```

---

## 6. é”™è¯¯ç è¯´æ˜

| é”™è¯¯ç  | è¯´æ˜ |
|--------|------|
| 200 | æˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªæˆæƒ |
| 403 | ç¦æ­¢è®¿é—® |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

---

## 7. æ³¨æ„äº‹é¡¹

1. **è®¤è¯è¦æ±‚**: æ¶ˆæ¯ä¸­å¿ƒåŠŸèƒ½éœ€è¦ç”¨æˆ·ç™»å½•
2. **åˆ†é¡µå‚æ•°**: é»˜è®¤é¡µç ä¸º1ï¼Œé¡µé¢å¤§å°ä¸º20ï¼Œæœ€å¤§é¡µé¢å¤§å°ä¸º100
3. **æ—¶é—´æ ¼å¼**: æ‰€æœ‰æ—¶é—´å­—æ®µä½¿ç”¨ISO 8601æ ¼å¼ï¼š`YYYY-MM-DDTHH:mm:ss`
4. **æ¶ˆæ¯ç±»å‹**: æ”¯æŒçš„æ¶ˆæ¯ç±»å‹åŒ…æ‹¬ï¼šLIKEï¼ˆç‚¹èµï¼‰ã€COMMENTï¼ˆè¯„è®ºï¼‰ã€SHAREï¼ˆåˆ†äº«ï¼‰ã€BOARDï¼ˆç•™è¨€æ¿ï¼‰ã€BOARD_REPLYï¼ˆç•™è¨€å›å¤ï¼‰
5. **ä¼šè¯ç±»å‹**: æ”¯æŒçš„ä¼šè¯ç±»å‹åŒ…æ‹¬ï¼šPRIVATEï¼ˆç§ä¿¡ï¼‰ã€GROUPï¼ˆç¾¤èŠï¼‰
6. **æ¶ˆæ¯çŠ¶æ€**: æ”¯æŒçš„æ¶ˆæ¯çŠ¶æ€åŒ…æ‹¬ï¼šACTIVEï¼ˆæ´»è·ƒï¼‰ã€INACTIVEï¼ˆéæ´»è·ƒï¼‰ã€DELETEDï¼ˆå·²åˆ é™¤ï¼‰

---

## æ¥å£è°ƒç”¨ç¤ºä¾‹

### å®Œæ•´çš„æ¶ˆæ¯ä¸­å¿ƒæµç¨‹

1. **è·å–ç‚¹èµé€šçŸ¥**
```http
GET /api/v1/messages/list?receiverId=123&messageType=LIKE&currentPage=1&pageSize=20
```

2. **è·å–è¯„è®ºé€šçŸ¥**
```http
GET /api/v1/messages/list?receiverId=123&messageType=COMMENT&currentPage=1&pageSize=20
```

3. **å‘è¡¨ç•™è¨€**
```http
POST /api/v1/messages
Content-Type: application/json

{
  "senderId": 123,
  "receiverId": 456,
  "content": "ä½ å¥½ï¼Œæˆ‘æƒ³å’Œä½ äº¤æµä¸€ä¸‹",
  "messageType": "BOARD",
  "isPublic": true
}
```

4. **å›å¤ç•™è¨€**
```http
POST /api/v1/messages
Content-Type: application/json

{
  "senderId": 456,
  "receiverId": 123,
  "parentMessageId": 3,
  "content": "å¥½çš„ï¼Œæˆ‘ä»¬å¯ä»¥äº¤æµä¸€ä¸‹",
  "messageType": "BOARD_REPLY"
}
```

5. **åˆ›å»ºç§ä¿¡ä¼šè¯**
```http
POST /api/v1/sessions
Content-Type: application/json

{
  "userId": 123,
  "otherUserId": 456,
  "sessionType": "PRIVATE",
  "title": "ç§ä¿¡ä¼šè¯",
  "description": "ç”¨æˆ·é—´çš„ç§ä¿¡äº¤æµ"
}
```

6. **æŸ¥è¯¢èŠå¤©è®°å½•**
```http
GET /api/v1/messages/chat-history?userId1=123&userId2=456&currentPage=1&pageSize=50
```

---

## åŠŸèƒ½å®Œæ•´æ€§è¯´æ˜

### âœ… **å®Œå…¨å®ç°çš„åŠŸèƒ½**
- **ç‚¹èµé€šçŸ¥æœç´¢**: é€šè¿‡MessageControllerå®ç°ï¼Œæ”¯æŒæŒ‰æ¶ˆæ¯ç±»å‹ç­›é€‰
- **è¯„è®ºé€šçŸ¥æœç´¢**: é€šè¿‡MessageControllerå®ç°ï¼Œæ”¯æŒæŒ‰æ¶ˆæ¯ç±»å‹ç­›é€‰
- **ç•™è¨€æ¿åŠŸèƒ½**: é€šè¿‡MessageControllerå®ç°ï¼Œæ”¯æŒå‘è¡¨ã€æ¥æ”¶ã€å›å¤ç•™è¨€
- **æ¶ˆæ¯ä¼šè¯ç®¡ç†**: é€šè¿‡MessageSessionControllerå®ç°ï¼Œæ”¯æŒä¼šè¯åˆ›å»ºå’Œç®¡ç†
- **èŠå¤©è®°å½•æŸ¥è¯¢**: é€šè¿‡MessageControllerå®ç°ï¼Œæ”¯æŒä¸¤ç”¨æˆ·é—´èŠå¤©è®°å½•æŸ¥è¯¢

### ğŸ”— **APIè·¯å¾„å¯¹åº”å…³ç³»**
- **æ¶ˆæ¯ç®¡ç†**: `GET /api/v1/messages/*` - MessageController
- **ä¼šè¯ç®¡ç†**: `POST /api/v1/sessions/*` - MessageSessionController
- **èŠå¤©è®°å½•**: `GET /api/v1/messages/chat-history` - MessageController

### ğŸ“Š **åŠŸèƒ½å®ç°ç‡: 100%**
æ‰€æœ‰æ¶ˆæ¯ä¸­å¿ƒæ¨¡å—æè¿°çš„åŠŸèƒ½éƒ½èƒ½é€šè¿‡ç°æœ‰APIå®Œå…¨å®ç°ã€‚

### ğŸ’¡ **æŠ€æœ¯å®ç°ç‰¹ç‚¹**
1. **ç»Ÿä¸€æ¶ˆæ¯ç³»ç»Ÿ**: æ‰€æœ‰ç±»å‹çš„æ¶ˆæ¯éƒ½é€šè¿‡ç»Ÿä¸€çš„æ¶ˆæ¯ç³»ç»Ÿç®¡ç†
2. **ä¼šè¯ç®¡ç†**: æ”¯æŒç§ä¿¡å’Œç¾¤èŠä¸¤ç§ä¼šè¯ç±»å‹
3. **æ¶ˆæ¯ç±»å‹**: æ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹çš„åˆ†ç±»å’Œç­›é€‰
4. **å®æ—¶é€šçŸ¥**: æ”¯æŒæœªè¯»æ¶ˆæ¯ç»Ÿè®¡å’ŒçŠ¶æ€ç®¡ç†
5. **èŠå¤©è®°å½•**: æ”¯æŒå†å²èŠå¤©è®°å½•çš„æŸ¥è¯¢å’Œåˆ†é¡µ
